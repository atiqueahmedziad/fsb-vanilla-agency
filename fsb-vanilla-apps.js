let goalAmount=0;const cors_api_url="https://fsb.vanilla-apps.com";async function doCORSRequest(a,b){return new Promise((c,d)=>{var e=new XMLHttpRequest;e.open(a.method,cors_api_url+a.url),e.onload=function(){b({method:a.method,url:a.url,status:e.status,statusText:e.statusText,responseText:e.responseText||""}),c()},e.onerror=function(a){d(a)},/^POST/i.test(a.method)&&e.setRequestHeader("Content-Type","application/json"),e.send(a.data)})}function setGoalAmount(a){goalAmount=a.responseText}function valWithDecimal(a){const b=a.toString();return b.slice(0,b.length-2)+"."+b.slice(b.length-2)}function getBarMessage(a,b){return(a=parseFloat(a),b=parseFloat(b),0===b)?`Buy $${a} to get free shipping!`:a>b?`Only $${a-b} away from free shipping`:a<=b?`Congratulations! You have got free shipping`:void 0}function updateFreeShippingBar(a,b){const c=getBarMessage(a,b);$(".free-shipping-bar").length?$(".free-shipping-bar .text-container").text(c):setupFreeShippingBar(c)}function setupFreeShippingBar(a){$("header").prepend(`<div class="free-shipping-bar-container"><div class="free-shipping-bar"><div class="text-container">${a}</div></div></div>`),$(".free-shipping-bar-container").css({display:"block",color:"inherit",height:"44px"}),$(".free-shipping-bar").css({opacity:"1",margin:"0px",padding:"0px",left:"0px",height:"auto",width:"100%","z-index":"100000001",position:"fixed",top:"0px"}),$(".free-shipping-bar .text-container").css({"text-align":"center",margin:"0px","margin-bottom":"0px",padding:"12px 10px",left:"0px",height:"auto",width:"100%","box-sizing":"border-box",border:"medium none","background-color":"rgb(30, 30, 32)",color:"rgb(242, 202, 128)","font-size":"16px","line-height":"20px","font-family":"Helvetica"}),$(".sticky").css("top","44px")}async function getTotalCartValue(){const a=await fetch(`${window.location.origin}/cart.js`);if(a.ok){const b=await a.json(),c=valWithDecimal(b.original_total_price);return c}console.error(a.status)}doCORSRequest({method:"post",url:"/api/getgoalamount",data:JSON.stringify({shopId:`${window.location.host}`})},setGoalAmount).then(()=>{getTotalCartValue().then(a=>{updateFreeShippingBar(goalAmount,a)})});const open=window.XMLHttpRequest.prototype.open;function openReplacement(){return this.addEventListener("load",function(){["/cart/add.js","/cart/update.js","/cart/change.js","/cart/clear.js"].includes(this._url)&&calculateShipping(this.response)}),open.apply(this,arguments)}window.XMLHttpRequest.prototype.open=openReplacement;async function calculateShipping(){const a=await getTotalCartValue();updateFreeShippingBar(goalAmount,a)}